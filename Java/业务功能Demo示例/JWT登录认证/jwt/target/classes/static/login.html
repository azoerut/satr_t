<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>jwt-demo</title>
</head>

<body>
    <!--post代表提交方式，action代表提交的地址-->
    <form id="loginForm" >
        账号：<input type="text" name="username" />
        密码：<input type="text" name="password" />
        <!--注意提交按钮在form表单中-->
        <input type="submit" value="登录" />
        <input type="submit" value="注册" />
    </form>
    <script src="Axios-1.5.0.js"></script>
    <script src="jquery-3.7.1.js"></script>
    <script>
        $(document).ready(function() {
            $('#loginForm').submit(function(event) {
                event.preventDefault(); // 阻止表单默认提交行为

                var username = $('#loginForm input[name="username"]').val(); // 获取用户名输入框的值
                var password = $('#loginForm input[name="password"]').val(); // 获取密码输入框的值

                // 构造要发送的数据对象
                var formData = {
                    username: username,
                    password: password
                };

                // 根据点击的按钮来确定发送的请求类型和后端接口地址
                var url = '/login'; // 默认为登录接口地址
                var btnValue = $(this).find('input[type="submit"]:focus').val(); // 获取点击的按钮的值
                if (btnValue === '注册') {
                    url = '/register'; // 如果点击的是 "注册" 按钮，则将请求地址修改为注册接口地址
                }

                var headers = {
                    'token': 'eyJhbGciOiJIUzI1NiJ9.eyJleHAiOjE3MTQyMzU1NzAsInVzZ…W4ifQ.pcyIqoWMgEn1KUWFNKwHf6Qq23P6b2zTxf2-VoJ_Ga0',
                    'Content-Type': 'application/json' // 指定发送的数据类型为 JSON
                };

                // 发送 AJAX 请求到后端
                $.ajax({
                    url: url, // 后端接口地址
                    type: 'POST', // 请求类型为POST
                    headers: headers,
                    contentType: 'application/json', // 指定发送的数据类型为JSON
                    data: JSON.stringify(formData), // 将数据转换为JSON字符串并发送
                    success: function(response) {
                        // 处理后端返回的响应
                        if (response) {
                            if (url === '/login') {
                                console.log('登录成功:', response);
                                // 在这里可以执行登录成功后的逻辑，比如跳转页面等
                            } else {
                                console.log('注册成功:', response);
                                // 在这里可以执行注册成功后的逻辑
                            }
                        } else {
                            alert("操作失败");
                        }
                    },
                    error: function(xhr, status, error) {
                        // 处理请求失败的情况
                        console.error('请求失败:', error);
                        alert("操作失败");
                    }
                });
            });
        });
    </script>
</body>

</html>